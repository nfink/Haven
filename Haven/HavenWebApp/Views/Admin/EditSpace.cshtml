@inherits Nancy.ViewEngines.Razor.NancyRazorViewBase<dynamic>
@using Haven;

@{
    var recallText = "";
    var recallSelected = "display: none;";
    var recallEditType = "editType" + ((int)SpaceType.Recall).ToString();
    var nameCardName = "";
    var nameCardDetails = "";
    var nameCardImage = "";
    var nameCardSelected = "display: none;";
    var nameCardEditType = "editType" + ((int)SpaceType.Challenge).ToString();
    var safeHavenCardName = "";
    var safeHavenCardDetails = "";
    var safeHavenCardImage = "";
    var safeHavenCardSelected = "display: none;";
    var safeHavenCardEditType = "editType" + ((int)SpaceType.SafeHaven).ToString();
    SpaceType spaceType = @Model.Type;
}
@if (@Model.BibleVerse != null)
{
        recallText = @Model.BibleVerse.Text;
}
@if (@Model.NameCard != null)
{
    nameCardName = @Model.NameCard.Name;
    nameCardDetails = @Model.NameCard.Details;
    nameCardImage = @Model.NameCard.Image.Filepath;
}
@if (@Model.SafeHavenCard != null)
{
    safeHavenCardName = @Model.SafeHavenCard.Name;
    safeHavenCardDetails = @Model.SafeHavenCard.Details;
    safeHavenCardImage = @Model.SafeHavenCard.Image.Filepath;
}
@switch(spaceType)
{
    case SpaceType.Recall:
        recallSelected = "";
        break;
    case SpaceType.Challenge:
        nameCardSelected = "";
        break;
    case SpaceType.SafeHaven:
        safeHavenCardSelected = "";
        break;
    default:
        break;
}

<form method="post" action="/Admin/Space/Edit" onsubmit="return EditSpace(this);">
    <div class="header">Edit Space</div>
    <input type="hidden" name="Id" value="@Model.Id" />
    <input type="hidden" name="BoardId" value="@Model.BoardId" />
    <input type="hidden" name="X" value="@Model.X" />
    <input type="hidden" name="Y" value="@Model.Y" />
    <div class="grid">
        <div class="row cells2">
            <div class="cell">
                <label for="spaceType">Type:</label>
                <br />
                <div class="input-control select">
                    <select id="spaceType" name="Type" onchange="TypeSelectionChange(this);">
                        @foreach (SpaceType type in Enum.GetValues(typeof(SpaceType)))
                        {
                            string selected = "";
                            if (@Model.Type == type)
                            {
                                selected = "selected";
                            }
                            <option value="@Convert.ChangeType(type, type.GetTypeCode())" @selected>@type.ToString()</option>
                        }
                    </select>
                </div>
                <br />
                <label for="spaceOrder">Order:</label>
                <br />
                <div class="input-control text">
                    <input id="spaceOrder" name="Order" type="text" value="@Model.Order" />
                </div>
            </div>
            <div class="cell">
                <div class="additionalEdit @recallEditType" style="@recallSelected">
                    <label for="spaceRecallText">Text:</label>
                    <br />
                    <div class="input-control text">
                        <input id="spaceRecallText" name="RecallText" type="text" value="@recallText" />
                    </div>
                </div>
                <div class="additionalEdit @nameCardEditType" style="@nameCardSelected">
                    <label for="spaceNameCardName">Name:</label>
                    <br />
                    <div class="input-control text">
                        <input id="spaceNameCardName" name="NameCardName" type="text" value="@nameCardName" />
                    </div>
                    <br />
                    <label for="spaceNameCardDetails">Details:</label>
                    <br />
                    <div class="input-control textarea">
                        <textarea id="spaceNameCardDetails" name="NameCardDetails">@nameCardDetails</textarea>
                    </div>
                    <br />
                    <div class="input-control text">
                        <input id="spaceNameCardImage" name="NameCardImage" type="text" value="@nameCardImage" />
                    </div>
                </div>
                <div class="additionalEdit @safeHavenCardEditType" style="@safeHavenCardSelected">
                    <label for="spaceSafeHavenCardName">Name:</label>
                    <br />
                    <div class="input-control text">
                        <input id="spaceSafeHavenCardName" name="SafeHavenCardName" type="text" value="@safeHavenCardName" />
                    </div>
                    <br />
                    <label for="spaceSafeHavenCardDetails">Details:</label>
                    <br />
                    <div class="input-control textarea">
                        <textarea id="spaceSafeHavenCardDetails" name="SafeHavenCardDetails">@safeHavenCardDetails</textarea>
                    </div>
                    <br />
                    <div class="input-control text">
                        <input id="spaceSafeHavenCardImage" name="SafeHavenCardImage" type="text" value="@safeHavenCardImage" />
                    </div>
                </div>
            </div>
        </div>
    </div>

    <button class="button primary" type="submit">Save</button>
    @if (@Model.Id != 0)
    {
        <button class="button primary" type="button" onclick="ConfirmDelete(function () { DeleteSpace(@Model.Id); });">Delete</button>
    }
    <button class="button primary" type="button" onclick="$('#editPane').empty();">Close</button>
</form>